var mycertRender={a:function(c){var d="";var b=c.obj;if(c.majname!=""){d=" - "+c.majname}var a=c.cname+d+" - "+c.regname+" - "+c.provname;b.val(a);b.data("mid",c.maj);b.data("zid",c.zid);b.data("rid",c.reg);b.data("prov",c.prov);baseRender.b(b);mycertRender.e(b)},b:function(c){var a=c.jtlname+" - "+c.jtype+" - "+c.jtname;var b=c.jtlid+"-"+c.jtypeid+"-"+c.jtid;$("#jtitle_selt").val(a);$("#jtitle_selt").data("ids",b)},c:function(a){$(a).unbind("click");$(a).bind("click",function(){var f=$(this).parent().find("input.qual_select");$(this).parent().find("span.blue").remove();$(this).remove();var d=f.parent().parent().html();var b=f.parent().find("input.qual_select");var i=b.attr("id");var g=b.val();var c=i.substring(5);c=parseInt((c==""?0:c),10)+1;var h=i.substring(0,5)+c;d=d.replace(i,h).replace(g,"");d="<tr>"+d+"</tr>";f.parent().parent().after(d);var e=$("#"+h);if(c==1){e.after(COMMONTEMP.T0016)}e.hgsSelect({id:"tqselect"+c,pid:"tregplace"+c,pshow:true,sprov:true,single:true,sure:mycertRender.a});mycertRender.d(e.parent().find("a.delqual"))})},d:function(a){$(a).unbind("click");$(a).bind("click",function(){var c=$(this).parent().parent().parent();var h=c.find("input.qual_select").length-1;var i=c.find("input.qual_select:eq("+h+")").attr("id");var j=$(this).parent().find("input.qual_select").attr("id");if(i==j){var e=COMMONTEMP.T0017;var f=$(this).parent().parent().parent().find("input.qual_select").length;if(f>2){e="<span class='blue'>| </span>"+e}var g=c.find("input.qual_select:eq("+(f-2)+")").parent();g.append(e);mycertRender.c(g.find("a.addqual"))}var b="#tqselect"+j.substring(5);var d="#tregplace"+j.substring(5);$(b).remove();$(d).remove();$(this).parent().parent().remove()})},e:function(d){var c=$(d);var a=c.parent().parent().parent().find("input.qual_select").length;var b=c.parent().parent().parent().find("a.addqual").length;if(a==1&&b==0){c.after(COMMONTEMP.T0017);this.c(c.parent().find("a.addqual"))}else{if(a>1&&b==0){c.parent().append("<span class='blue'>| </span>"+COMMONTEMP.T0017);this.c(c.parent().find("a.addqual"))}}},f:function(c){try{var a=$(c).val();if(mycertRender.g(a)){$("#form_upload").submit()}}catch(b){mycertRender.h(b)}},g:function(a){if(/^.*?\.(gif|png|jpg|jpeg|bmp)$/i.test(a)){return true}alert("图片格式不正确，请选择图片。");return false},h:function(a){if(typeof a=="undefined"){alert("上传失败，刷新页面或稍后再试。")}else{alert(a)}},l:function(b){var a=$(b).parent();if(a.find("a.asubmit").length==0){a.append('<a href="javascript:;" class="red asubmit">确定上传</a>')}$(b).css("width","auto");MycertController.d(b)},m:function(a){if(a){alert("上传成功!");var c=$("#form_upload table a.cur_file");c.prev().prev().text("文件已上传,待审核").css("color","#c00");c.prev().remove();c.parent().find("a.alter").remove();c.remove()}else{alert("上传失败!")}},n:function(a){alert("删除错误,请刷新页面再试!")},o:function(a){alert("添加成功!","","","",function(){location.reload()})},p:function(a){alert(a.data)},q:function(d){var c=d.obj;var a=d.jtlname+" - "+d.jtype+" - "+d.jtname;var b=d.jtlid+","+d.jtid;c.val(a);c.data("ids",b);MycertController.m()},r:function(c){var b=$(c).parent();var a=b.parent().find("span.tname");a.hide();b.find("a.alter").remove();b.find("#qtitle").val(a.text()).fadeIn(200)},s:function(d){var b=$(d).parent();var a='<span class="gray">未认证</span><input type="file" name="file_tcert" class="files"/>';b.parent().append(a);b.parent().find("span.green").remove();b.find("a.opencont").unbind("click");b.find("a.opencont").text("修改").addClass("alter").removeClass("opencont");var c=MycertController;c.ac($("#htit").parent().find("input[name='file_tcert']"));c.la(b.find("a.alter"))}};

var MycertController={a:function(){$("#tqual").hgsSelect({id:"tqselect",pid:"tregplace",pshow:true,sprov:true,single:true,sure:mycertRender.a})},b:function(){$("#detime").datepicker({showOn:"both",buttonImageOnly:true,yearRange:"1900:2012",buttonText:"点击选择日期",dateFormat:"yy-mm-dd",changeMonth:true,changeYear:true})},c:function(){var a=$("input.files");if(a.length>0){this.ac(a)}},ac:function(a){$(a).bind("change",function(){mycertRender.l(this)})},d:function(b){var a=$(b);a.parent().find("a.asubmit").unbind("click").bind("click",function(){a.parent().parent().find("a.asubmit").removeClass("cur_file");$(this).addClass("cur_file");$("#upfname").val(a.attr("name"));$("#upfcid").val($(this).parent().find("div").attr("cid"));mycertRender.f(a)})},e:function(){var a=$("#form_upload table td div a.delecert");if(a.length>0){a.bind("click",function(){mycertRender.l(this)})}},f:function(a){$(a).bind("click",function(){var b=$(this).parent().attr("cid");$(this).parent().parent().parent().remove();var d=mycertRender;var c=new Cert();c.DeleTCert(b,null,d.n)})},g:function(){$("#savebtn").bind("click",function(){$("#tqual").trigger("blur");var h=$("table.tb_cert");if(h.find("div.tip").length==0){var f=h.find("input.qual_select");var e="",d="",j="";$.each(f,function(c,l){var b="";var a=$(l).data("mid");var k=$(l).data("zid");if(!!a){b=a}else{if(!!k){b=k}}if(c>0&&b!=""){e+=","+b;d+=","+$(l).data("rid");j+=","+$(l).data("prov")}else{if(c==0&&b!=""){e+=b;d+=$(l).data("rid");j+=$(l).data("prov")}}});var i=mycertRender;var g=new Cert();g.AddTCert(e,j,d,i.o,i.p)}})},h:function(){$("#tqual").focus(function(){baseRender.b(this)}).blur(function(){MycertController.i(this,LANGUAGE.L0159)})},i:function(e,a){var c="";var d=true;var b=$(e).val().replace(new RegExp(" ","g"),"");if(b==""){c=a;d=false}if(!d){baseRender.a(e,c,"error",0)}else{baseRender.b(e)}},j:function(){baseController.BtnBind("div.btn4","btn4","btn4_hov","btn4_click")},k:function(){$("#qtitle").hgsSelect({type:"jobtitle",tid:"tqtitle",sure:mycertRender.q})},l:function(){var a=$("#form_upload table td div a.alter");if(a.length>0){this.la(a)}},la:function(a){$(a).unbind("click").bind("click",function(){mycertRender.r(this)})},m:function(){var c=["",""];var d=$("#qtitle"),b=d.parent().parent().attr("cid");if(d.data("ids")){c=d.data("ids").split(",")}var f=mycertRender;var e=new Cert();e.UpdateTTitle(b,c[1],c[0],null,f.p)},n:function(){var a=$("#htit a.opencont");if(a.length>0){a.unbind("click").bind("click",function(){var d=mycertRender;d.s(this);var b=$("#htit").attr("cid");var c=new Cert();c.RemoveTitleCt(b,null,d.p)})}},IniPage:function(){baseRender.ae(0);this.j();this.a();this.c();this.h();this.g();this.l();this.k();this.n();this.f($("#form_upload table.tb td a.delecert"))}};$().ready(function(){if(typeof(PAGE)=="undefined"){PAGE=""}if(PAGE=="57"){MycertController.IniPage()}});