(function(a){a.extend({hgsGenBCardCover:function(d){if(a("#"+d).length==0){var b='<div class="cards_cover prom_card" id="'+d+'"><div class="card_header"><div class="c_h_cont"><div class="c_h_l lf"><a href="javascript:;" class="card_close" title="关闭"></a><a href="javascript:;" class="card_close closetxt" title="关闭">返回</a></div><div class="c_h_r rf"><span class="gray">步骤: 1、选择合适的推广方式， 2、选购周数, 3、点击“立即推广”即可!</span></div><p class="clr"></p></div></div><div class="select_bg bcard_data"></div></div>';a("body").append(b);var c=a("#"+d);c.find("a.card_close").unbind("click").bind("click",function(){c.fadeOut()})}},hgsParOptions:{}});a.extend(a.fn,{hgsShowBCard:function(c){var e={id:"",url:"",durl:"",getId:null,type:"",cback:null};var f=this;var d=a.extend(e,c);var b={_showCard:function(){if(a("div#"+d.id).length==0){a.hgsGenBCardCover(d.id)}}};a(f).unbind("click").bind("click",function(){a.hgsParOptions=d;b._showCard();var g=d.getId(this);a.hgsParOptions.proid=g;a.hgsParOptions.cur=this;f.hgsGetBCards(d.durl,g)})},hgsGenBCardsCnt:function(h,e,c){var g=a(h);var d=g.hgsGenBOptions(e),b=g.hgsGenBOptions(c);var f='<div class="bc_item"><div class="top"><p class="lf"></p><p class="rf"></p></div><div class="middle"><div class="mbg"><div class="title"><span>推广方式</span><em>1</em><span class="grayer"> - 个人首页推荐</span></div><div class="lf prompic prompic1"></div><div class="lf promoper promoper1"><p class="promcount">说明：共 <span class="count">'+e.m_count+'</span> 条信息备选推送,由系统随机推送到各个角色首页显示</p><p class="baseintro">说明：您的推广信息将优先显示在各角色的首页显示</p><p class="prompay prompay1">费用：<em class="red">\u00A5</em><span class="red">'+e.price+'</span>/周</p><p class="getdays">请选择购买周数：<select class="pday">'+d+'</select> 周</p><p class="leftcount">已有 <span class="lftcount">'+(parseInt(e.m_count,10)-parseInt(e.s_count,10))+'</span> 人购买此服务,现剩余 <span class="red">'+e.s_count+'</span> 个名额</p><p class="nosell">购买名额已满,您暂不能购买,明天再来看看吧</p><p class="hasget">您已购买该服务,到期时间为 <span class="red">'+e.date+'</span></p><div class="probtn_cont"><div class="btn_common btn5"><span class="b_lf"></span><span class="b_rf"></span><a href="javascript:;" class="btn white promotenow" st="'+e.id+'">立即推广</a></div></div></div><p class="clr"></p></div></div><div class="bot"><p class="lf"></p><p class="rf"></p></div></div>';f+='<div class="bc_item"><div class="top"><p class="lf"></p><p class="rf"></p></div><div class="middle"><div class="mbg"><div class="title"><span>推广方式</span><em>2</em><span class="grayer"> - 职讯推荐列表优先排序</span></div><div class="lf prompic prompic2"></div><div class="lf promoper promoper2"><p class="promcount">说明：共 <span class="count">'+c.m_count+'</span> 条信息备选推送,由系统随机推送到职讯推荐列表中</p><p class="baseintro">说明：您的推广信息将优先显示在推荐列表中</p><p class="prompay prompay2">费用：<em class="red">\u00A5</em><span class="red">'+c.price+'</span>/周</p><p class="getdays">请选择购买周数：<select class="pday1">'+b+'</select> 周</p><p class="leftcount">已有 <span class="lftcount">'+(parseInt(c.m_count,10)-parseInt(c.s_count,10))+'</span> 人购买此服务,现剩余 <span class="red">'+c.s_count+'</span> 个名额</p><p class="nosell">购买名额已满,您暂不能购买,明天再来看看吧</p><p class="hasget">您已购买该服务,到期时间为 <span class="red">'+c.date+'</span></p><div class="probtn_cont"><div class="btn_common btn5"><span class="b_lf"></span><span class="b_rf"></span><a href="javascript:;" class="btn white zxpromotenow" st="'+c.id+'">立即推广</a></div></div></div><p class="clr"></p></div></div><div class="bot"><p class="lf"></p><p class="rf"></p></div></div>';g.find("div.bcard_data").append(f)},hgsGenBOptions:function(f){var e="";var d=parseInt(f.min_days,10),b=parseInt(f.max_days,10)+1;for(var c=d;c<b;c++){e+="<option value='"+c+"'>"+c+"</option>"}return e},hgsIniBCards:function(j,d){var i=a(j);var h=i.find("div.btn5 a");if(h.length==0){h=i.find("div.btn7 a")}if(d.status==1){i.find("p.baseintro,p.hasget").css("display","block");i.find("p.hasget span.red").text(d.date);var e=i.find("div.btn5");baseController.BtnUnbind(e);e.find("a").unbind("click");e.removeClass("btn5").addClass("btn7")}else{if(d.m_count=="-1"){i.find("p.baseintro,p.prompay,p.getdays").css("display","block");i.find("p.prompay span.red").text(d.price);var b=i.hgsGenBOptions(d);i.find("p.getdays select").html(b);i.hgsPromBtnClick(h)}else{if(d.s_count>0){i.find("p.promcount,p.prompay,p.getdays,p.leftcount").css("display","block");i.find("p.promcount span.count").text(d.m_count);i.find("p.prompay span.red").text(d.price);i.find("p.leftcount span.lftcount").text(parseInt(d.m_count,10)-parseInt(d.s_count,10));i.find("p.leftcount span.red").text(d.s_count);i.find("div.btn_common a").attr("st",d.id);var g=i.hgsGenBOptions(d);i.find("p.getdays select").html(g);i.hgsPromBtnClick(h)}else{i.find("p.promcount,p.prompay,p.getdays,p.nosell").css("display","block");i.find("p.promcount span.count").text(d.m_count);i.find("p.prompay span.red").text(d.price);var c=i.hgsGenBOptions(d);i.find("p.getdays select").html(c);var f=i.find("div.btn5");baseController.BtnUnbind(f);f.find("a").unbind("click");f.removeClass("btn5").addClass("btn7")}}}},hgsGenBCards:function(e){var f="#"+a.hgsParOptions.id;var d=e.data;var c=d[0],b=d[1];if(a(f+" div.bc_item").length==0){a(f).hgsGenBCardsCnt(f,c,b)}a(f).find("div.promoper p").css("display","none");a(f).hgsIniBCards(f+" div.promoper1",c);a(f).hgsIniBCards(f+" div.promoper2",b);a(f).fadeIn(200)},hgsPromBtnClick:function(c){var b=a(c).parent();b.removeClass("btn7").addClass("btn5");baseController.BtnBind(b,"btn5","btn5_hov","btn5_click");a(c).unbind("click").bind("click",function(){var g=a.hgsParOptions;var i=g.proid;var f=g.type;var e=g.url;var d=a(this).attr("st");var h=a(this).parent().parent().parent().find("p select").val();a(this).hgsGetPromdata(i,f,e,d,h)})},hgsGetPromdata:function(h,e,c,f,g){var b=this;var d={url:c,params:"id="+h+"&&type="+e+"&&service="+f+"&&days="+g,sucrender:b.hgsBtnSuc,failrender:b.hgsBCardsFail};HGS.Base.HAjax(d)},hgsGetBCards:function(c,e){var b=this;var d={url:c,params:"id="+e,sucrender:b.hgsGenBCards,failrender:b.hgsBCardsFail};HGS.Base.HAjax(d)},hgsBtnSuc:function(c){var b=a.hgsParOptions;b.cback(b.cur);alert("推广成功!");a("#"+a.hgsParOptions.id).fadeOut(400)},hgsBCardsFail:function(b){if(typeof(b.data)=="undefined"){alert("推广功能暂未开放")}else{if(b.data=="YEBZ0001"){paytipController.NoScore()}else{alert(b.data)}}}})})(jQuery);